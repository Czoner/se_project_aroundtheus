!function(){"use strict";class e{constructor(e,t,s,r,i){this._data=e,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteModal=r,this._handleLikes=i,this._isLiked=e.isLiked}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>{this._handleLikes(this)})),this._cardElement.querySelector(".card__trash").addEventListener("click",(()=>{this._handleDeleteModal(this)})),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}isLiked(){return this._isLiked}getId(){return this._id}handleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};_getLikedStatus(){this.isLiked()?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}getview(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._setEventListeners();const e=this._cardElement.querySelector(".card__title");return this._cardImageElement.src=this._data.link,this._cardImageElement.alt=this._data.name,e.textContent=this._data.name,this._getLikedStatus(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_checkFormValidity=()=>this._inputElements.every((e=>e.validity.valid));toggleButtonState(){if(!this._checkFormValidity())return this._submitButton.classList.add(this._settings.inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputElements=Array.from(this._form.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._form.querySelector(this._settings.submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._form.reset(),this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal_opened")&&this.close(),e.target.classList.contains("modal__close")&&this.close()}))}}class r extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._popupInputs=this._popupForm.querySelectorAll(".modal__input"),this._savingButton=this._popupForm.querySelector(".modal__button"),this._savingButtonText=this._savingButton.textContent}setInputValues(e){this._popupInputs.forEach((t=>{t.value=e[t.name]}))}close(){this._popupForm.reset(),super.close()}getInputValues(){const e={};return this._popupInputs.forEach((t=>{e[t.name]=t.value})),e}saving(e){this._savingButton.textContent=e?"Saving...":this._savingButtonText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this.getInputValues()),this.close()}))}}const i=document.querySelector("#edit-profile-modal"),n=(i.querySelector(".modal__close"),i.querySelector(".modal__form")),o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__info"),l=a.querySelector(".profile__title"),d=a.querySelector(".profile__description"),c=document.querySelector("#profile-title-edit"),u=i.querySelector("#profile-description-edit"),h=document.querySelector(".profile__image_edit"),_=document.querySelector(".profile__add-button"),m=document.querySelector("#add-modal"),p=(m.querySelector(".modal__close"),m.querySelector("#add-card-info").querySelector(".modal__input_type_title"),document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".modal-images-preview")),v=(document.querySelector(".modal__preview"),p.querySelector(".modal__close"),document.querySelector(".modal__title"),document.querySelectorAll(".modal"),new r("#add-modal",(function(e){const t={name:e.title,link:e.link};v.saving(!0),f.createCard(t).then((e=>{const t=B({name:e.name,link:e.link,_id:e._id,isLiked:e.isLiked});A.addItem(t),v.saving(!1),w["add-card-form"].resetValidation()}))})));v.setEventListeners();const E=new class extends s{constructor(e){super({popupSelector:e}),this._deletePopup=this._popupElement.querySelector(".modal__form")}setYesAction(e){this._handleYesAction=e}setEventListeners(){super.setEventListeners(),this._deletePopup.addEventListener("submit",(e=>{e.preventDefault(),this._handleYesAction()}))}}("#confirmation-modal");E.setEventListeners();const f=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInformation(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then((e=>e.json()))}profileInfo(){return Promise.all(this.getInitialCards(),this.userInformation())}createCard(e){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return console.log("cardid",e),fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deletingLikes(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addingLikes(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updatingLikeStatus(e,t){return e?this.deletingLikes(t):this.addingLikes(t)}updatingProfileImage(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"79fb9209-ee9a-4da9-a138-5a38df01e74c","Content-Type":"application/json"}}),g=document.querySelector(".profile__image"),S=new class{constructor(e,t,s){this._name=e,this._about=t,this._avatar=s}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){this._name.textContent=e.name,this._about.textContent=e.about}setAvatar(e){this._avatar.src=e}}(l,d,g),L=new r("#edit-profile-modal",(e=>{S.setUserInfo(e),L.saving(!0),f.editUserInfo(e).then((()=>{L.saving(!1),S.setUserInfo(e)}))}));L.setEventListeners();const y=new class extends s{constructor(e){super({popupSelector:e}),this._image=document.querySelector(".modal__preview"),this._title=document.querySelector(".modal__title")}open(e){super.open(),this._image.setAttribute("src",e.link),this._image.setAttribute("alt",e.name),this._title.textContent=e.name}}(".modal-images-preview");y.setEventListeners();const k=new class extends s{constructor(e){super({popupSelector:e}),this._profileImgPopup=this._popupElement.querySelector(".modal__form")}setEventListeners(){super.setEventListeners(),this._profileImgPopup.addEventListener("submit",(e=>{e.preventDefault()}))}}("#edit-profile-image");k.setEventListeners();const b=new r("#edit-profile-image",(function(e){b.saving(!0),f.updatingProfileImage(e.link).then((e=>{S.setAvatar(e.avatar),b.saving(!1)}))}));function I(e){f.updatingLikeStatus(e.isLiked(),e.getId()).then((()=>{e.handleLikeIcon()}))}function q(e){E.open(),E.setYesAction((()=>{f.deleteCard(e.id).then((()=>{E.close(),e.handleDeleteCard()})).catch((e=>{console.error(e)})).finally((()=>{E.setYesAction(!1)}))}))}function C(e){y.open(e)}function B(t){return new e(t,"#card-template",C,q,I).getview()}b.setEventListeners(),f.getUserInformation().then((e=>{S.setUserInfo({name:e.name,about:e.about}),S.setAvatar(e.avatar)})),h.addEventListener("click",(()=>{k.open()})),o.addEventListener("click",(function(){w[n.getAttribute("name")].resetValidation(),L.open();const e=S.getUserInfo();c.value=e.name,u.value=e.about})),_.addEventListener("click",(()=>{v.open()}));const w={};var U;U={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(U.formSelector)).forEach((e=>{const s=new t(U,e),r=e.getAttribute("name");w[r]=s,s.enableValidation()}));const A=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}rendererItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=B(e);A.addItem(t)}},".cards__list");f.getInitialCards().then((e=>{A.rendererItems(e)})).catch((e=>{console.error(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNqQjFMLEtBQUs0TCxXQUFhcEssU0FBU1osY0FBYzZLLEVBQzNDLENBRUFJLGFBQUFBLENBQWNDLEdBQ1pBLEVBQU1oSSxTQUFTaUksSUFDYi9MLEtBQUsyTCxVQUFVSSxFQUFLLEdBRXhCLENBRUF6RSxPQUFBQSxDQUFRMEUsR0FDTmhNLEtBQUs0TCxXQUFXSyxRQUFRRCxFQUMxQixHTjZKQSxDQUNFTixTQUFXSyxJQUNULE1BQU1HLEVBQWNqRixFQUFXOEUsR0FDL0IxRSxFQUFRQyxRQUFRNEUsRUFBWSxHQUdoQyxnQkFHRmxGLEVBQ0dnQixrQkFDQWQsTUFBTTRFLElBQ0x6RSxFQUFRd0UsY0FBY0MsRUFBTSxJQUU3QmhCLE9BQU9FLElBQ041QixRQUFRNEIsTUFBTUEsRUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFByb2ZpbGVJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZU1vZGFsLFxuICAgIGhhbmRsZUxpa2VzXG4gICAgLy8gaGFuZGxlRGVsZXRlZExpa2VzXG4gICkge1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZU1vZGFsID0gaGFuZGxlRGVsZXRlTW9kYWw7XG4gICAgdGhpcy5faGFuZGxlTGlrZXMgPSBoYW5kbGVMaWtlcztcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VzKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlTW9kYWwodGhpcyk7XG4gICAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XG4gICAgfSk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XG4gICAgLy8gaWYodGhpcy5faXNMaWtlZCkgYWRkIG9yIHJlbW92ZSBjbGFzc0xpc3RcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgX2dldExpa2VkU3RhdHVzKCkge1xuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBnZXR2aWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIGNvbnN0IGltYWdlVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fZGF0YS5uYW1lO1xuICAgIGltYWdlVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLm5hbWU7XG4gICAgdGhpcy5fZ2V0TGlrZWRTdGF0dXMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICB9XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuICB9O1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzRm9ybVZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcbiAgICBpZiAoIWlzRm9ybVZhbGlkKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBJbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5fc2F2aW5nQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zYXZpbmdCdXR0b25UZXh0ID0gdGhpcy5fc2F2aW5nQnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX3BvcHVwSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX3BvcHVwSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBzYXZpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc2F2aW5nQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2aW5nQnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc2F2aW5nQnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBvYmplY3QxID0ge1xuICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgb2JqZWN0MiA9IHtcbiAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgb2JqZWN0MyA9IHtcbiAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgb2JqZWN0NCA9IHtcbiAgbmFtZTogXCJMYXRlbWFyXCIsXG4gIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxufTtcblxuZXhwb3J0IGNvbnN0IG9iamVjdDUgPSB7XG4gIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxufTtcblxuZXhwb3J0IGNvbnN0IG9iamVjdDYgPSB7XG4gIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG59O1xuXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICBvYmplY3QxLFxuICBvYmplY3QyLFxuICBvYmplY3QzLFxuICBvYmplY3Q0LFxuICBvYmplY3Q1LFxuICBvYmplY3Q2LFxuXTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID1cbiAgcHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbEZvcm0gPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IGRlc2NyaXB0aW9uSm9iID0gcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1lZGl0XCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVkaXQgPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1lZGl0XCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VfZWRpdFwiKTtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRTdWJtaXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1pbmZvXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRUaXRsZSA9IGFkZENhcmRTdWJtaXQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfdGl0bGVcIlxuKTtcblxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWwtaW1hZ2VzLXByZXZpZXdcIlxuKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlld1wiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VDbG9zZSA9XG4gIHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fdGl0bGVcIik7XG5cbmV4cG9ydCBjb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgXCIuLi9wYWdlL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aFByb2ZpbGVJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhQcm9maWxlSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7XG4gIHByb2ZpbGVUaXRsZSxcbiAgZGVzY3JpcHRpb25Kb2IsXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxuICBwcm9maWxlVGl0bGVFZGl0LFxuICBwcm9maWxlRGVzY3JpcHRpb25FZGl0LFxuICBhZGRDYXJkQnV0dG9uLFxuICBhZGRDYXJkU3VibWl0LFxuICBwcm9maWxlTW9kYWxGb3JtLFxuICBpbml0aWFsQ2FyZHMsXG4gIHByZXZpZXdJbWFnZUVsZW1lbnQsXG4gIHByZXZpZXdJbWFnZVRpdGxlLFxuICBjb25maWcsXG4gIGNhcmRMaXN0LFxuICBjYXJkVGVtcGxhdGUsXG4gIHByb2ZpbGVFZGl0SW1hZ2UsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgbmV3Q2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLW1vZGFsXCIsIGhhbmRsZUNhcmRGb3JtU3VibWl0KTtcbm5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uc3QgY29uZmlybWF0aW9uTW9kYWwgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2NvbmZpcm1hdGlvbi1tb2RhbFwiKTtcbmNvbmZpcm1hdGlvbk1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjc5ZmI5MjA5LWVlOWEtNGRhOS1hMTM4LTVhMzhkZjAxZTc0Y1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuXG5jb25zdCB1c2VySW5mb3JtYXRpb24gPSBuZXcgVXNlckluZm8oXG4gIHByb2ZpbGVUaXRsZSxcbiAgZGVzY3JpcHRpb25Kb2IsXG4gIHByb2ZpbGVJbWFnZVxuKTtcbmNvbnN0IG5ld1Byb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiLCAodmFsdWVzKSA9PiB7XG4gIHVzZXJJbmZvcm1hdGlvbi5zZXRVc2VySW5mbyh2YWx1ZXMpO1xuICBuZXdQcm9maWxlTW9kYWwuc2F2aW5nKHRydWUpO1xuICBhcGkuZWRpdFVzZXJJbmZvKHZhbHVlcykudGhlbigoKSA9PiB7XG4gICAgbmV3UHJvZmlsZU1vZGFsLnNhdmluZyhmYWxzZSk7XG4gICAgdXNlckluZm9ybWF0aW9uLnNldFVzZXJJbmZvKHZhbHVlcyk7XG4gIH0pO1xufSk7XG5uZXdQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmNvbnN0IGltYWdlUHJldmlldyA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5tb2RhbC1pbWFnZXMtcHJldmlld1wiKTtcbmltYWdlUHJldmlldy5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwcm9maWxlSW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhQcm9maWxlSW1hZ2UoXCIjZWRpdC1wcm9maWxlLWltYWdlXCIpO1xucHJvZmlsZUltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcHJvZmlsZUF2YXRhckVkaXQgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjZWRpdC1wcm9maWxlLWltYWdlXCIsXG4gIGhhbmRsZVByb2ZpbGVBdmF0YXJcbik7XG5wcm9maWxlQXZhdGFyRWRpdC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hcGkuZ2V0VXNlckluZm9ybWF0aW9uKCkudGhlbigodXNlcikgPT4ge1xuICB1c2VySW5mb3JtYXRpb24uc2V0VXNlckluZm8oeyBuYW1lOiB1c2VyLm5hbWUsIGFib3V0OiB1c2VyLmFib3V0IH0pO1xuICB1c2VySW5mb3JtYXRpb24uc2V0QXZhdGFyKHVzZXIuYXZhdGFyKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVDYXJkRm9ybVN1Ym1pdChkYXRhKSB7XG4gIGNvbnN0IGNhcmRJbmZvID0ge1xuICAgIG5hbWU6IGRhdGEudGl0bGUsXG4gICAgbGluazogZGF0YS5saW5rLFxuICB9O1xuICBuZXdDYXJkTW9kYWwuc2F2aW5nKHRydWUpO1xuICBhcGkuY3JlYXRlQ2FyZChjYXJkSW5mbykudGhlbigocmVzKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoe1xuICAgICAgbmFtZTogcmVzLm5hbWUsXG4gICAgICBsaW5rOiByZXMubGluayxcbiAgICAgIF9pZDogcmVzLl9pZCxcbiAgICAgIGlzTGlrZWQ6IHJlcy5pc0xpa2VkLFxuICAgIH0pO1xuICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICBuZXdDYXJkTW9kYWwuc2F2aW5nKGZhbHNlKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlcyhjYXJkKSB7XG4gIGFwaS51cGRhdGluZ0xpa2VTdGF0dXMoY2FyZC5pc0xpa2VkKCksIGNhcmQuZ2V0SWQoKSkudGhlbigoKSA9PiB7XG4gICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlTW9kYWwoY2FyZCkge1xuICBjb25maXJtYXRpb25Nb2RhbC5vcGVuKCk7XG4gIGNvbmZpcm1hdGlvbk1vZGFsLnNldFllc0FjdGlvbigoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5jbG9zZSgpO1xuICAgICAgICBjYXJkLmhhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5zZXRZZXNBY3Rpb24oZmFsc2UpO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlQXZhdGFyKGltZykge1xuICBwcm9maWxlQXZhdGFyRWRpdC5zYXZpbmcodHJ1ZSk7XG4gIGFwaS51cGRhdGluZ1Byb2ZpbGVJbWFnZShpbWcubGluaykudGhlbigodXNlcikgPT4ge1xuICAgIHVzZXJJbmZvcm1hdGlvbi5zZXRBdmF0YXIodXNlci5hdmF0YXIpO1xuICAgIHByb2ZpbGVBdmF0YXJFZGl0LnNhdmluZyhmYWxzZSk7XG4gIH0pO1xufVxuXG5wcm9maWxlRWRpdEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVJbWFnZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XG4gIGZvcm1WYWxpZGF0b3JzW3Byb2ZpbGVNb2RhbEZvcm0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIG5ld1Byb2ZpbGVNb2RhbC5vcGVuKCk7XG4gIGNvbnN0IHVzZXJJbmZvID0gdXNlckluZm9ybWF0aW9uLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUVkaXQudmFsdWUgPSB1c2VySW5mby5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25FZGl0LnZhbHVlID0gdXNlckluZm8uYWJvdXQ7XG59XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmaWxsUHJvZmlsZUZvcm0pO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG5ld0NhcmRNb2RhbC5vcGVuKCk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XG4gIGltYWdlUHJldmlldy5vcGVuKGRhdGEpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGluaXRpYWxDYXJkcykge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgaW5pdGlhbENhcmRzLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZU1vZGFsLFxuICAgIGhhbmRsZUxpa2VzXG4gICk7XG4gIHJldHVybiBjYXJkLmdldHZpZXcoKTtcbn1cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuZW5hYmxlVmFsaWRhdGlvbihjb25maWcpO1xuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoaXRlbXMpID0+IHtcbiAgICBzZWN0aW9uLnJlbmRlcmVySXRlbXMoaXRlbXMpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0pO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9kZWxldGVQb3B1cCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgc2V0WWVzQWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVllc0FjdGlvbiA9IGFjdGlvbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZGVsZXRlUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlWWVzQWN0aW9uKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvcm1hdGlvbigpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpO1xuICB9XG5cbiAgcHJvZmlsZUluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMudXNlckluZm9ybWF0aW9uKCkpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHZhbHVlcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogdmFsdWVzLmFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkaWQpIHtcbiAgICBjb25zb2xlLmxvZyhcImNhcmRpZFwiLCBjYXJkaWQpO1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZGlkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGluZ0xpa2VzKGNhcmRpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZGlkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRpbmdMaWtlcyhjYXJkaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRpbmdMaWtlU3RhdHVzKGlzTGlrZWQsIGNhcmRpZCkge1xuICAgIGlmIChpc0xpa2VkKSB7XG4gICAgICByZXR1cm4gdGhpcy5kZWxldGluZ0xpa2VzKGNhcmRpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZGluZ0xpa2VzKGNhcmRpZCk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRpbmdQcm9maWxlSW1hZ2UoaW1hZ2UpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBpbWFnZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lLCBhYm91dCwgYXZhdGFyKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQgPSBhYm91dDtcbiAgICB0aGlzLl9hdmF0YXIgPSBhdmF0YXI7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8odXNlcikge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSB1c2VyLm5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xuICB9XG5cbiAgc2V0QXZhdGFyKGxpbmspIHtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gbGluaztcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlld1wiKTtcbiAgICB0aGlzLl90aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RpdGxlXCIpO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLmxpbmspO1xuICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLm5hbWUpO1xuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoUHJvZmlsZUltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3Byb2ZpbGVJbWdQb3B1cCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wcm9maWxlSW1nUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlTW9kYWwiLCJoYW5kbGVMaWtlcyIsInRoaXMiLCJfZGF0YSIsIl9pZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVNb2RhbCIsIl9oYW5kbGVMaWtlcyIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2FyZEltYWdlRWxlbWVudCIsImdldElkIiwiaGFuZGxlTGlrZUljb24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfZ2V0TGlrZWRTdGF0dXMiLCJhZGQiLCJyZW1vdmUiLCJoYW5kbGVEZWxldGVDYXJkIiwiZ2V0dmlldyIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImltYWdlVGl0bGUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJfaW5wdXRFbGVtZW50cyIsImV2ZXJ5IiwiaW5wdXQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9zdWJtaXRCdXR0b24iLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsImlucHV0RWxlbWVudCIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwSW5wdXRzIiwiX3NhdmluZ0J1dHRvbiIsIl9zYXZpbmdCdXR0b25UZXh0Iiwic2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsImdldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsInNhdmluZyIsImlzTG9hZGluZyIsInByb2ZpbGVNb2RhbCIsInByb2ZpbGVNb2RhbEZvcm0iLCJlZGl0UHJvZmlsZUJ1dHRvbiIsInByb2ZpbGVGb3JtRWxlbWVudCIsInByb2ZpbGVUaXRsZSIsImRlc2NyaXB0aW9uSm9iIiwicHJvZmlsZVRpdGxlRWRpdCIsInByb2ZpbGVEZXNjcmlwdGlvbkVkaXQiLCJwcm9maWxlRWRpdEltYWdlIiwiYWRkQ2FyZEJ1dHRvbiIsImFkZENhcmRNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJuZXdDYXJkTW9kYWwiLCJjYXJkSW5mbyIsInRpdGxlIiwiYXBpIiwiY3JlYXRlQ2FyZCIsInRoZW4iLCJyZXMiLCJjYXJkIiwic2VjdGlvbiIsImFkZEl0ZW0iLCJmb3JtVmFsaWRhdG9ycyIsImNvbmZpcm1hdGlvbk1vZGFsIiwiX2RlbGV0ZVBvcHVwIiwic2V0WWVzQWN0aW9uIiwiYWN0aW9uIiwiX2hhbmRsZVllc0FjdGlvbiIsIm9wdGlvbnMiLCJiYXNlVXJsIiwiaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvcm1hdGlvbiIsInByb2ZpbGVJbmZvIiwiYWxsIiwidXNlckluZm9ybWF0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckluZm8iLCJ2YWx1ZXMiLCJhYm91dCIsImRlbGV0ZUNhcmQiLCJjYXJkaWQiLCJjb25zb2xlIiwibG9nIiwiZGVsZXRpbmdMaWtlcyIsImFkZGluZ0xpa2VzIiwidXBkYXRpbmdMaWtlU3RhdHVzIiwidXBkYXRpbmdQcm9maWxlSW1hZ2UiLCJpbWFnZSIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlSW1hZ2UiLCJfbmFtZSIsIl9hYm91dCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwidXNlciIsInNldEF2YXRhciIsIm5ld1Byb2ZpbGVNb2RhbCIsImltYWdlUHJldmlldyIsIl9pbWFnZSIsIl90aXRsZSIsInNldEF0dHJpYnV0ZSIsInByb2ZpbGVJbWFnZU1vZGFsIiwiX3Byb2ZpbGVJbWdQb3B1cCIsInByb2ZpbGVBdmF0YXJFZGl0IiwiaW1nIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsImZpbmFsbHkiLCJpbml0aWFsQ2FyZHMiLCJnZXRBdHRyaWJ1dGUiLCJ1c2VySW5mbyIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJjYXJkRWxlbWVudCJdLCJzb3VyY2VSb290IjoiIn0=